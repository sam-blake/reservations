<% if @empty %>
  $('#cart_dates').replaceWith('<%= escape_javascript(render :partial => 'reservations/cart_dates') %>');
  <% if params[:controller] == "catalog" %>
    $('#catalog_listing').html('<%= escape_javascript( render partial: 'catalog/catalog_listing', locals: { eq_models_by_category: @eq_models_by_category, availability_hash: @availability_hash, available_string: @available_string })%>');
    truncate();
  <% end %>
<% end %>
$('#list_items_in_cart').replaceWith('<%= escape_javascript(render :partial => 'reservations/list_items_in_cart') %>');
<% # availability updates %>
<% if @ems %>
  <% @ems.each do |em| %>
    $('<%= "#availability_#{em}" %>').html(<%= @availability_hash[em] %>);
    <% if @availability_hash[em] <= 0 %>
      $('<%= "#add_to_cart_#{em}" %>').children('.btn').addClass('disabled', 'add_to_cart_disabled');
      $('<%= "#add_to_cart_#{em}" %>').children('.btn').removeClass('add_to_cart');
    <% else %>
      $('<%= "#add_to_cart_#{em}" %>').children('.btn').removeClass('disabled', 'add_to_cart_disabled');
      $('<%= "#add_to_cart_#{em}" %>').children('.btn').addClass('add_to_cart');
    <% end %>
  <% end %>
<% end %>
resume_cart();
<% if @empty %>
  load_datepicker();
<% end %>

<% if (flash[:error].blank? && flash[:notice].blank? && flash[:alert].blank?) %>
  $('#flashes').replaceWith('<div id="flashes"></div>');
<% else %>
  $('#flashes').replaceWith('<div id = "flashes" ><%= escape_javascript(render :partial => 'layouts/flash_alerts') %></div>');
  <% flash.clear %>
<% end %>
